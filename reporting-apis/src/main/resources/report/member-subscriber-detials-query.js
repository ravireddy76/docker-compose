db.member.aggregate([ { $match: {"memberbenefit": { $exists: true, $ne: null }} }, memGroupIdKey, govBenefitTypeKey, { $project: { "memGroupId": { $arrayElemAt: ["$subsaffiliation.memGroupID", 0]}, "govtBenefitType": { $arrayElemAt: ["$membercob.govtBenefitType", 0]}, "memberbenefit":"$memberbenefit", "memberName": { $concat :[ "$nameFirst", ", ", "$nameLast"] }, "dob": "$birthDate", "gender":"$gender", "address1": { $arrayElemAt: ["$memberaddress.address1", 0]}, "address2": { $arrayElemAt: ["$memberaddress.address2", 0]}, "city": { $arrayElemAt: ["$memberaddress.city", 0]}, "state": { $arrayElemAt: ["$memberaddress.state", 0]}, "zipCode":{ $arrayElemAt: ["$memberaddress.postalCode", 0]}, "branding":{ $arrayElemAt: [ { $arrayElemAt: ["$subsaffiliation.memberserviceplan.brandingEntity", 0]}, 0] } } } ])